## Какие участки памяти очищаются

Go GC очищает исключительно кучу — область динамической памяти, куда попадают все значения, «убегающие» из стека после escape-анализa. Стековые кадры горутин и статические данные (data-сегмент) в зону действия GC не входят — их размер меняется отдельно другими механизмами runtime.

 ### Механизм сборки мусора
 Используется tri-color, mark-and-sweep механизм.

**Фаза маркировки**:
- **Initial Mark (STW пауза):** все объекты считаются белыми; сборщик кратковременно останавливает мир (stop the world) и помечает корни (глобалы и стеки горутин) серыми, добавляя их в очередь обхода
    
- **Concurrent Mark:** в фоновом режиме GC берёт серые объекты, сканирует их поля на указатели, чёрнит их и превращает вновь достижимые белые объекты в серые, пока очередь не опустеет
    
- **Mark Termination:** после исчерпания очереди все недостижимые объекты остаются белыми и готовы к удалению 

**Фаза очистки**

Сборщик проходит по span-областям heap, освобождая белые объекты и возвращая память в пул аллокатора для повторного использования


Большая часть работы выполняется параллельно с приложением (mutator), но для initial mark и завершения sweep делается короткая STW-пауза; write barrier запускается при каждой записи указателя в кучу и гарантирует, что чёрные объекты не будут ссылаться на белые, иначе белый объект будет сразу перекрашен в серый 
  
